{"version":3,"sources":["docs/js/app.js"],"names":["test","navigator","userAgent","window","MSStream","vendor","mouseDownY","req","usePicture","pictureUrl","videoUrl","fps","totalFrames","duration","markers","pictures","concurrent","scrolling","pow","end","endTime","previous","direction","diff","index","page","document","querySelector","container","preload","video","picture","track","steps","captionItems","Array","prototype","slice","call","querySelectorAll","playerTime","markerTime","player","scrollbar","Scrollbar","use","OverscrollPlugin","init","plugins","overscroll","addListener","e","offset","limit","offsetWidth","offsetHeight","onScrollbarShouldScrollTo","options","selector","scrollTo","x","y","pause","console","log","setAttribute","resume","setScrollbar","setProgress","loaded","total","percent","parseInt","innerHTML","Init","addEventListener","onTrack","eventOptions","onMouseDown","onMove","onUp","onWheel","onTouchDown","onscroll","onScroll","requestAnimationFrame","animate","setCaptionItems","filter","caption","distance","Math","abs","currentTime","play","setTime","i","max","min","round","src","frame","requests","onCheckNextPicture","length","push","onLoadNextPicture","XMLHttpRequest","open","split","join","responseType","onload","this","status","blob","response","image","URL","createObjectURL","shift","onerror","send","PreloadPictures","onprogress","videoBlob","source","error","autoplay","mute","promise","undefined","then","catch","html","toFixed","addSteps","timeapi","peformance","performance","Date","fpsInterval","now","elapsed","paused","step","trackHeight","onLoop","preventDefault","stopImmediatePropagation","target","getAttribute","setIndex","parentNode","children","indexOf","getY","clientY","touches","pageY","shouldLockScroll","flag","previousY","scrubStart","onDown","stopPropagation","innerHeight","time","item","setNearestDirection","wheelDirection","deltaY","previousMarker","nextMarker","$","slick","PointerEvent","passive","capture","removeEventListener"],"mappings":"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","file":"app.min.js","sourcesContent":["/* global window, document, console  */\n\n(function () {\n    'use strict';\n\n    var iOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n    var isChrome = /Chrome/.test(navigator.userAgent) && /Google Inc/.test(navigator.vendor);\n\n    var usePicture = false;\n    var pictureUrl = 'img/campagnolo/campagnolo_{0}.jpg';\n    var videoUrlWebm = 'img/campagnolo.webm';\n    var videoUrlMp4 = 'img/campagnolo2.mp4';\n    var videoUrlCheck = 'img/Chrome_ImF.webm';\n    var videoUrl = videoUrlMp4; // iOS ? videoUrlMp4 : videoUrlWebm;\n    var fps = 25.0;\n    var totalFrames = 498;\n    var duration = totalFrames / fps;\n    var currentTime = 0.0;\n    var pageOffset = 0.0;\n    var currentMarker = 0.0;\n    var markers = [0, 2.14, 5.22, 9.16, 12.13, 16.08, duration];\n    var pictures = [];\n    var concurrent = 15;\n\n    var speed, mouseDownY;\n    var scrolling = {\n        pow: 0,\n        end: 0,\n        endTime: 0,\n        previous: 0,\n        direction: 0,\n        diff: 0,\n        index: 0,\n    };\n\n    var page = document.querySelector('.page');\n    var container = document.querySelector('.container');\n    var preload = document.querySelector('.preload');\n    var video = document.querySelector('.video');\n    var picture = document.querySelector('.picture');\n    var track = document.querySelector('.track');\n    var steps = document.querySelector('.steps');\n    var captions = document.querySelector('.captions');\n    var captionItems = Array.prototype.slice.call(document.querySelectorAll('.captions-item'));\n    var playerTime = document.querySelector('.player-time');\n    var markerTime = document.querySelector('.marker-time');\n    var player = video;\n\n    var scrollbar = setScrollbar();\n\n    if (usePicture) {\n        container.setAttribute('class', 'container container-picture loading');\n        player = picture;\n        player.currentTime = 0.0;\n        player.duration = duration;\n        player.play = player.pause = function () {};\n        player.setTime = function () {\n            var i = Math.max(1, Math.min(totalFrames, Math.round(player.currentTime * fps)));\n            if (player.index !== i) {\n                player.index = i;\n                // console.log(i, pictures[i]);\n                player.src = pictures[i];\n            }\n        };\n        PreloadPictures();\n    } else {\n        container.setAttribute('class', 'container container-video loading');\n        player = video;\n        player.setTime = function () {};\n        PreloadVideo();\n    }\n\n    function addSteps() {\n        for (var i = 0; i < markers.length; i++) {\n            var marker = markers[i];\n            var html = '<div class=\"step\" style=\"top:' + (marker / duration * 100).toFixed(3) + '%\"></div>';\n            steps.innerHTML += html;\n            // console.log(steps, html);\n        }\n    }\n    addSteps();\n\n    function setProgress(loaded, total) {\n        var progress = loaded / total;\n        var percent = parseInt(progress * 100);\n        preload.innerHTML = percent;\n        // console.log(percent);\n    }\n\n    function PreloadPictures() {\n        var total = totalFrames;\n        var loaded = 0;\n        var frame = 0;\n        var requests = [];\n\n        function onCheckNextPicture() {\n            while (requests.length < concurrent && frame < total) {\n                requests.push(true);\n                onLoadNextPicture(++frame);\n            }\n        }\n\n        function onLoadNextPicture(frame) {\n            var req = new XMLHttpRequest();\n            req.open('GET', pictureUrl.split('{0}').join(frame), true);\n            req.responseType = 'blob';\n            req.onload = function () {\n                if (this.status === 200) {\n                    var blob = this.response;\n                    var image = URL.createObjectURL(blob); // IE10+\n                    pictures[frame] = image;\n                    loaded++;\n                    requests.shift();\n                    setProgress(loaded, total);\n                    if (loaded === total) {\n                        player.setTime();\n                        Init();\n                    } else {\n                        onCheckNextPicture();\n                    }\n                }\n            };\n            req.onerror = function (e) {\n                console.log('preload.error', e);\n            };\n            req.send();\n        }\n        onCheckNextPicture();\n    }\n\n    function PreloadVideo() {\n        var req = new XMLHttpRequest();\n        req.open('GET', videoUrl, true);\n        req.responseType = 'blob';\n        req.onprogress = function (e) {\n            setProgress(e.loaded, e.total);\n        };\n        req.onload = function () {\n            if (this.status === 200) {\n                var videoBlob = this.response;\n                var source = URL.createObjectURL(videoBlob); // IE10+\n                video.addEventListener('progress', function (e) {\n                    console.log('video.progress', e, video.duration);\n                }, false);\n                video.addEventListener('error', function (e) {\n                    console.log('video.error', e, video.error);\n                });\n                video.autoplay = true;\n                video.mute = true;\n                video.src = source;\n                var promise = video.play();\n                if (promise !== undefined) {\n                    promise.then(function () {\n                        Init();\n                    }).catch(function (e) {\n                        console.log('video.error', e, video.error);\n                    });\n                } else {\n                    Init();\n                }\n            }\n        };\n        req.onerror = function (e) {\n            console.log('preload.error', e);\n        };\n        req.send();\n    }\n\n    function Init() {\n        if (usePicture) {\n            container.setAttribute('class', 'container container-picture');\n        } else {\n            container.setAttribute('class', 'container container-video');\n        }\n        scrolling.pow = scrolling.end = 0;\n        speed = 0.0;\n        mouseDownY = null;\n\n        video.pause();\n\n        addMouseEvents();\n        addTouchEvents();\n\n        window.onscroll = onScroll;\n        // setInterval(onLoop, 1000.0 / fps);\n        window.requestAnimationFrame(animate);\n\n        setCaptionItems(1);\n    }\n\n    function elastic(pow) {\n        var accelamount = 0.05; //How fast the video will try to catch up with the target position. 1 = instantaneous, 0 = do nothing.\n        var bounceamount = 0.7; //value from 0 to 1 for how much backlash back and forth you want in the easing. 0 = no bounce whatsoever, 1 = lots and lots of bounce\n        speed += (scrolling.end - pow) * accelamount;\n        speed = Math.max(-1, Math.min(1, speed));\n        pow = (pow + speed) * (bounceamount) + (scrolling.end * (1 - bounceamount));\n        return pow;\n    }\n\n    function setCaptionItems(direction) {\n        captionItems.filter(function (caption, index) {\n            var distance = markers[index] - scrolling.pow * player.duration;\n            if (Math.abs(distance) > 2) {\n                caption.setAttribute('class', 'captions-item');\n            } else if (direction > 0) {\n                caption.setAttribute('class', 'captions-item ' + (distance > -0.1 ? 'entering' : 'exiting'));\n            } else if (direction < 0) {\n                caption.setAttribute('class', 'captions-item ' + (distance < 0.1 ? 'entering' : 'exiting'));\n            }\n        });\n    }\n\n    function onLoop() {\n        if (player.duration) {\n            if (mouseDownY) {\n                scrolling.pow = scrolling.end;\n                player.pause();\n                player.currentTime = scrolling.pow * player.duration;\n                player.setTime();\n            } else {\n                if (scrolling.end !== scrolling.pow) {\n                    /*\n                    if (timeDirection > 0 && player.paused) {\n                        player.play();\n                    } else if (timeDirection < 0 && !player.paused) {\n                        player.pause();\n                    }\n                    */\n                    if (!player.paused) {\n                        player.pause();\n                    }\n                    var diff = scrolling.end - scrolling.pow;\n                    var step = 1.0 / fps;\n                    if (Math.abs(diff * player.duration) < step) {\n                        scrolling.pow = scrolling.end;\n                    } else {\n                        var direction = diff ? diff / Math.abs(diff) : 0;\n                        scrolling.pow += (step * direction) / player.duration;\n                    }\n                    var currentTime = Math.round(scrolling.pow * player.duration / step) * step + 0.00001;\n                    player.currentTime = currentTime;\n                    player.setTime();\n                }\n            }\n            var trackHeight = track.offsetHeight;\n            playerTime.setAttribute('style', 'top:' + ((player.currentTime / player.duration) * trackHeight) + 'px;');\n            setCaptionItems(scrolling.direction);\n        }\n    }\n\n    var timeapi = window.peformance ? performance : Date;\n    var fpsInterval = 1000 / fps,\n        now = 0,\n        then = 0,\n        elapsed = 0;\n\n    function animate() {\n        // calc elapsed time since last loop\n        now = timeapi.now();\n        elapsed = now - then;\n        // if enough time has elapsed, draw the next frame\n\n        if (elapsed > fpsInterval) {\n\n            // Get ready for next frame by setting then=now, but also adjust for your\n            // specified fpsInterval not being a multiple of RAF's interval (16.7ms)\n            then = now - (elapsed % fpsInterval);\n\n            // Put your drawing code here\n            onLoop();\n        }\n        // request another frame\n        requestAnimationFrame(animate);\n    }\n\n    function onTrack(e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n        if (e.target.getAttribute('class') === 'step') {\n            var nodes = Array.prototype.slice.call(e.target.parentNode.children);\n            var index = nodes.indexOf(e.target);\n            setIndex(index);\n        }\n        return false;\n    }\n\n    function getY(e) {\n        return e.clientY || e.touches[0].pageY;\n    }\n\n    function shouldLockScroll(direction) {\n        var flag = false;\n        if ((scrolling.pow < 1.0 && direction === 1) || (scrollbar.offset.y < 10 && direction === -1)) {\n            flag = true;\n        }\n        if (flag) {\n            scrollbar.pause();\n        } else {\n            scrollbar.resume();\n        }\n        console.log('shouldLockScroll', flag, direction, scrolling.pow, scrollbar.offset.y, direction);\n        return flag;\n    }\n\n    var previousY,\n        scrubStart = 0.0;\n\n    function onDown(e) {\n        if (scrollbar.offset.y < 10) {\n            var y = getY(e);\n            // console.log('onDown', y);\n            mouseDownY = y;\n            scrubStart = scrolling.end || 0;\n            if (shouldLockScroll(1)) {\n                e.preventDefault();\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                return false;\n            }\n        }\n    }\n\n    function onMove(e) {\n        if (mouseDownY) {\n            var y = getY(e);\n            // console.log('onMove', y);\n            previousY = y;\n            if (Math.abs(mouseDownY - y) > 1) {\n                var min = 0,\n                    max = 1,\n                    pow = (mouseDownY - y) / (window.innerHeight * 3);\n                scrolling.end = Math.max(0, Math.min(1, scrubStart + pow));\n                // console.log('onMove', scrubStart, pow);\n                setScroll();\n            }\n            var direction = y - mouseDownY > 0 ? -1 : 1;\n            if (shouldLockScroll(direction)) {\n                e.preventDefault();\n                e.stopPropagation();\n                e.stopImmediatePropagation();\n                return false;\n            }\n        }\n    }\n\n    function onUp(e) {\n        if (mouseDownY) {\n            var y = previousY;\n            // console.log('onUp', y);\n            var diff = (mouseDownY - y);\n            // console.log(y, mouseDownY, diff);\n            if (diff) {\n                mouseDownY = null;\n                var direction = diff / Math.abs(diff);\n\n                var time = scrolling.end * player.duration;\n                markers.filter(function (item, index) {\n                    if (time > item && time < markers[index + 1]) {\n                        scrolling.index = index + (direction > 0 ? 0 : 1);\n                        // console.log('scrolling.index', scrolling.index);\n                    }\n                });\n\n                setNearestDirection(direction);\n                setScroll();\n            }\n        }\n    }\n\n    function onWheel(e) {\n        var wheelDirection = e.deltaY / Math.abs(e.deltaY);\n        setNearestDirection(wheelDirection);\n        setScroll();\n        if (shouldLockScroll(wheelDirection)) {\n            e.preventDefault();\n            e.stopPropagation();\n            e.stopImmediatePropagation();\n            // scrollbar.setPosition(0, 0);\n            // console.log('onWheel', e);\n            return false;\n        }\n    }\n\n    function onScroll() {\n        /*\n        updateTime();\n        if (!mouseDownY) {\n            var time = getNearestMarker(scrolling.end * player.duration);\n            scrolling.end = time / player.duration;\n        }\n        */\n        var trackHeight = track.offsetHeight;\n        markerTime.setAttribute('style', 'top : ' + (scrolling.end * (trackHeight - 30)) + 'px;');\n\n\n        // this.current = window.scrollY\n        /*\n        this.options.last = Object(d.a)(this.options.last, this.options.current, this.options.ease), \n        this.options.last = Math.floor(100 * this.options.last) / 100;\n            var t = +((this.options.current - this.options.last) / this.wh);\n            c.a.set(this.el, {\n                y: -this.options.last,\n                skewY: 10 * t\n            }), this.rAF = requestAnimationFrame(this.run)\n        */\n    }\n\n    function setIndex(index) {\n        // console.log('setIndex', index);\n        if (index !== scrolling.index) {\n            var direction = (index - scrolling.index) / Math.abs(index - scrolling.index);\n            var previousMarker = markers[scrolling.index];\n            var nextMarker = markers[index];\n            var currentTime = scrolling.pow * player.duration;\n            if (currentTime >= Math.min(previousMarker, nextMarker) && currentTime <= Math.max(previousMarker, nextMarker)) {\n                scrolling.index = index;\n                scrolling.endTime = markers[scrolling.index];\n                scrolling.direction = direction;\n                scrolling.end = scrolling.endTime / player.duration;\n                // console.log('setNearestDirection', index, previousMarker, nextMarker, currentTime);\n                var trackHeight = track.offsetHeight;\n                markerTime.setAttribute('style', 'top : ' + (scrolling.end * (trackHeight)) + 'px;');\n                $('.slick').slick('slickGoTo', index);\n            }\n        }\n    }\n\n    function setNearestDirection(direction) {\n        var index = scrolling.index;\n        if (direction === 1) {\n            index = Math.min(markers.length - 1, scrolling.index + 1);\n        } else {\n            index = Math.max(0, scrolling.index - 1);\n        }\n        setIndex(index);\n    }\n\n    function setScroll() {\n        /*\n        var containerHeight = container.offsetHeight;\n        // var contentHeight = content.offsetHeight;\n        var min = 0,\n            max = containerHeight, // (contentHeight - containerHeight),\n            top = scrolling.end * max;\n        window.scrollTo(0, Math.max(min, Math.min(max, top)));\n        */\n    }\n\n    /*\n    function updateTime() {\n        var containerHeight = container.offsetHeight;\n        var contentHeight = content.offsetHeight;\n        var min = 0,\n            max = player.duration,\n            end = window.pageYOffset / (contentHeight - containerHeight);\n        scrolling.end = Math.max(min, Math.min(max, end));\n        scrolling.diff = scrolling.end - scrolling.previous;\n        scrolling.direction = scrolling.diff / Math.abs(scrolling.diff);\n        scrolling.previous = scrolling.end;\n        markerTime.setAttribute('style', 'top : ' + (15 + (scrolling.end * (containerHeight - 30))) + 'px;');\n    }\n    */\n\n    function getNearestMarker(time) {\n        var marker = markers.reduce(function (prev, curr) {\n            return (Math.abs(curr - time) < Math.abs(prev - time) ? curr : prev);\n        });\n        return marker;\n    }\n\n    function getMarker(forward) {\n        var marker = null;\n        if (Math.abs(currentMarker - player.currentTime) < 1.0) {\n            markers.filter(function (item) {\n                if (marker === null && (item > currentMarker || !forward)) {\n                    marker = item;\n                }\n            });\n        } else {\n            marker = currentMarker;\n        }\n        console.log(currentMarker, player.currentTime);\n        return marker;\n    }\n\n    /*\n    var isPlaying = video.currentTime > 0 && !video.paused && !video.ended \n        && video.readyState > 2;\n\n    if (!isPlaying) {\n      video.play();\n    }\n\n    */\n\n    var eventOptions = window.PointerEvent ? {\n        passive: false,\n        capture: true,\n    } : undefined;\n\n    function onMouseDown(e) {\n        removeTouchEvents();\n        onDown(e);\n    }\n\n    function onTouchDown(e) {\n        removeMouseEvents();\n        onDown(e);\n    }\n\n    function addMouseEvents() {\n        track.addEventListener('mousedown', onTrack, eventOptions);\n        window.addEventListener('mousedown', onMouseDown, eventOptions);\n        window.addEventListener('mousemove', onMove, eventOptions);\n        window.addEventListener('mouseup', onUp, eventOptions);\n        window.addEventListener('mouseleave', onUp, eventOptions);\n        container.addEventListener('wheel', onWheel);\n    }\n\n    function removeMouseEvents() {\n        track.removeEventListener('mousedown', onTrack);\n        window.removeEventListener('mousedown', onMouseDown);\n        window.removeEventListener('mousemove', onMove);\n        window.removeEventListener('mouseup', onUp);\n        window.removeEventListener('mouseleave', onUp);\n        // container.removeEventListener('wheel', onWheel);\n        console.log('removeMouseEvents');\n    }\n\n    function addTouchEvents() {\n        track.addEventListener('touchstart', onTrack, eventOptions);\n        window.addEventListener('touchstart', onTouchDown, eventOptions);\n        window.addEventListener('touchmove', onMove, eventOptions);\n        window.addEventListener('touchend', onUp, eventOptions);\n    }\n\n    function removeTouchEvents() {\n        track.removeEventListener('touchstart', onTrack);\n        window.removeEventListener('touchstart', onTouchDown);\n        window.removeEventListener('touchmove', onMove);\n        window.removeEventListener('touchend', onUp);\n        console.log('removeTouchEvents');\n    }\n\n    function setScrollbar() {\n        Scrollbar.use(window.OverscrollPlugin);\n        var scrollbar = Scrollbar.init(page, {\n            plugins: {\n                overscroll: {},\n            },\n        });\n\n        function onChange(e) {\n            // console.log('scrollbar.onChange', e.offset.y, e.limit.y, native.offsetHeight);\n            var object = {\n                offset: e.offset,\n                limit: e.limit,\n                container: {\n                    width: page.offsetWidth,\n                    height: page.offsetHeight,\n                }\n            };\n            // console.log('Scrollbar.onChange', object);\n        }\n        scrollbar.addListener(onChange);\n        scrollbar.onScrollbarShouldScrollTo = function (options) {\n            // console.log('Scrollbar.onScrollbarShouldScrollTo', options);\n            if (document.querySelector(options.selector) === page) {\n                scrollbar.scrollTo(options.x || 0, options.y || 0, 500);\n            }\n        };\n        scrollbar.pause = function () {\n            // scrollbar.destroy();\n            console.log(scrollbar);\n            page.setAttribute('class', 'page locked');\n        };\n        scrollbar.resume = function () {\n            // return setScrollbar();\n            page.setAttribute('class', 'page');\n        };\n        return scrollbar;\n    }\n\n    /*\n    $(document).ready(function () {\n        var slick = $('.slick').slick({\n            infinite: false,\n            slidesToShow: 1,\n            slidesToScroll: 1,\n            vertical: true,\n            arrows: false,\n            dots: false,\n            swipe: false,\n            swipeToSlide: false,\n            verticalSwiping: false,\n        });\n    });\n    */\n\n}());\n\n/*\nfunction() {\n    function t(e) {\n        s()(this, t), this.createBound(), this.content = e.querySelector(\".js-scroll-content\"), this.el = this.content.querySelector(\".js-scroll-section\"), this.rAF = void 0, this.options = {\n            current: 0,\n            last: 0,\n            ease: this.el.dataset.ease || .15\n        }, this.wh = window.innerHeight, this.setHeight()\n    }\n    return o()(t, [{\n        key: \"init\",\n        value: function() {\n            this.addEvents(), this.preload()\n        }\n    }, {\n        key: \"createBound\",\n        value: function() {\n            var t = this;\n            [\"setHeight\", \"scroll\", \"run\"].forEach(function(e) {\n                return t[e] = t[e].bind(t)\n            })\n        }\n    }, {\n        key: \"setHeight\",\n        value: function() {\n            var t = this.content.getBoundingClientRect().height;\n            c.a.set(document.body, {\n                height: t\n            })\n        }\n    }, {\n        key: \"preload\",\n        value: function() {\n            var t = this;\n            u()(this.content, function(e) {\n                t.setHeight()\n            })\n        }\n    }, {\n        key: \"scroll\",\n        value: function() {\n            this.options.current = window.scrollY\n        }\n    }, {\n        key: \"run\",\n        value: function() {\n            this.options.last = Object(d.a)(this.options.last, this.options.current, this.options.ease), this.options.last = Math.floor(100 * this.options.last) / 100;\n            var t = +((this.options.current - this.options.last) / this.wh);\n            c.a.set(this.el, {\n                y: -this.options.last,\n                skewY: 10 * t\n            }), this.rAF = requestAnimationFrame(this.run)\n        }\n    }, {\n        key: \"on\",\n        value: function() {\n            (!(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]) && this.requestAnimationFrame()\n        }\n    }, {\n        key: \"off\",\n        value: function() {\n            (!(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]) && this.cancelAnimationFrame()\n        }\n    }, {\n        key: \"requestAnimationFrame\",\n        value: function(t) {\n            function e() {\n                return t.apply(this, arguments)\n            }\n            return e.toString = function() {\n                return t.toString()\n            }, e\n        }(function() {\n            this.rAF = requestAnimationFrame(this.run)\n        })\n    }, {\n        key: \"cancelAnimationFrame\",\n        value: function(t) {\n            function e() {\n                return t.apply(this, arguments)\n            }\n            return e.toString = function() {\n                return t.toString()\n            }, e\n        }(function() {\n            cancelAnimationFrame(this.rAF)\n        })\n    }, {\n        key: \"destroy\",\n        value: function() {\n            c.a.set(document.body, {\n                height: \"auto\"\n            }), this.el = void 0, this.removeEvents()\n        }\n    }, {\n        key: \"addEvents\",\n        value: function() {\n            this.on(), window.addEventListener(\"resize\", this.setHeight, !1), window.addEventListener(\"scroll\", this.scroll, !1)\n        }\n    }, {\n        key: \"removeEvents\",\n        value: function() {\n            this.off(), window.removeEventListener(\"resize\", this.setHeight, !1), window.removeEventListener(\"scroll\", this.scroll, !1)\n        }\n    }])\n*/"]}