!function(){"use strict";var r,e,t=!1,a="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",s=25,d=498,o=d/s,c=[0,2.14,5.22,9.16,12.13,16.08,o],u=[],l=15,m={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},v=document.querySelector(".container"),w=document.querySelector(".content"),i=document.querySelector(".preload"),p=document.querySelector(".video"),f=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=document.querySelector(".circle-time"),T=document.querySelector(".circle-scroll"),E=p;function x(e,t){var n=parseInt(100*(e/t));i.innerHTML=n}function M(){t?v.setAttribute("class","container container-picture"):v.setAttribute("class","container container-video"),m.pow=m.end=0,0,r=null,p.pause(),h.addEventListener("mousedown",Y),window.addEventListener("mousedown",X),window.addEventListener("mousemove",j),window.addEventListener("mouseup",U),window.addEventListener("mouseleave",U),window.addEventListener("wheel",D),h.addEventListener("touchstart",Y),window.addEventListener("touchstart",N),window.addEventListener("touchmove",j),window.addEventListener("touchend",U),window.onscroll=F,window.requestAnimationFrame(H)}t?(v.setAttribute("class","container container-picture loading"),(E=f).currentTime=0,E.duration=o,E.play=E.pause=function(){},E.setTime=function(){var e=Math.max(1,Math.min(d,Math.round(E.currentTime*s)));E.index!==e&&(E.index=e,E.src=u[e])},function(){var o=d,i=0,e=0,r=[];function s(){for(;r.length<l&&e<o;)r.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",a.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);u[n]=t,i++,r.shift(),x(i,o),i===o?(E.setTime(),M()):s()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}s()}()):(v.setAttribute("class","container container-video loading"),(E=p).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);p.src=t,M()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var b=window.peformance?performance:Date,y=1e3/s,q=0,S=0,A=0;function H(){q=b.now(),y<(A=q-S)&&(S=q-A%y,function(){if(E.duration){if(r)m.pow=m.end,E.pause(),E.currentTime=m.pow*E.duration,E.setTime();else if(m.end!==m.pow){E.paused||E.pause();var e=m.end-m.pow,t=1/s;if(Math.abs(e*E.duration)<t)m.pow=m.end;else{var n=e?e/Math.abs(e):0;m.pow+=t*n/E.duration}var o=Math.round(m.pow*E.duration/t)*t+1e-5;E.currentTime=o,E.setTime()}var i=v.offsetHeight;w.offsetHeight,L.setAttribute("style","top:"+(15+E.currentTime/E.duration*(i-30))+"px;")}}()),requestAnimationFrame(H)}function Y(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&G(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}var k=0;function R(e){r=e.clientY,k=m.end||0,console.log("onDown",r,k)}function j(e){if(r&&1<Math.abs(r-e.clientY)){var t=(r-e.clientY)/(3*window.innerHeight);m.end=Math.max(0,Math.min(1,k+t)),I()}}function U(e){if(r){var t=r-e.clientY;if(console.log(e.clientY,r,t),t){r=null;var n=t/Math.abs(t),o=m.end*E.duration;c.filter(function(e,t){e<o&&o<c[t+1]&&(m.index=t+(0<n?0:1))}),O(n),I()}}}function D(e){O(e.deltaY/Math.abs(e.deltaY)),I()}function F(){var e=v.offsetHeight;T.setAttribute("style","top : "+(15+m.end*(e-30))+"px;")}function G(e){if(e!==m.index){var t=(e-m.index)/Math.abs(e-m.index),n=c[m.index],o=c[e],i=m.pow*E.duration;if(i>=Math.min(n,o)&&i<=Math.max(n,o)){m.index=e,m.endTime=c[m.index],m.direction=t,m.end=m.endTime/E.duration;var r=v.offsetHeight;T.setAttribute("style","top : "+(15+m.end*(r-30))+"px;"),$(".slick").slick("slickGoTo",e)}}}function O(e){m.index;G(1===e?Math.min(c.length-1,m.index+1):Math.max(0,m.index-1))}function I(){var e=v.offsetHeight,t=w.offsetHeight-e,n=m.end*t;window.scrollTo(0,Math.max(0,Math.min(t,n)))}function X(e){h.removeEventListener("touchstart",Y),window.removeEventListener("touchstart",N),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",U),console.log("removeTouchEvents"),R(e)}function N(e){h.removeEventListener("mousedown",Y),window.removeEventListener("mousedown",X),window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",U),window.removeEventListener("mouseleave",U),window.removeEventListener("wheel",D),console.log("removeMouseEvents"),R(e)}$(document).ready(function(){$(".slick").slick({infinite:!1,slidesToShow:1,slidesToScroll:1,vertical:!0,arrows:!1,dots:!1,swipe:!1,swipeToSlide:!1,verticalSwiping:!1})})}();
//# sourceMappingURL=app.min.js.map
