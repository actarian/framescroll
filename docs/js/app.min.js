!function(){"use strict";/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);var i,e,t=!1,s="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",a=25,u=498,o=u/a,c=[0,2.14,5.22,9.16,12.13,16.08,o],d=[],l=15,r=function(){var t=document.querySelector(".page");Scrollbar.use(window.OverscrollPlugin);var n=Scrollbar.init(t,{plugins:{overscroll:{}}});return n.addListener(function(e){e.offset,e.limit,t.offsetWidth,t.offsetHeight}),n.onScrollbarShouldScrollTo=function(e){document.querySelector(e.selector)===t&&n.scrollTo(e.x||0,e.y||0,500)},n}(),v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},p=document.querySelector(".container"),m=document.querySelector(".preload"),f=document.querySelector(".video"),w=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=(document.querySelector(".captions"),Array.prototype.slice.call(document.querySelectorAll(".captions-item"))),y=document.querySelector(".player-time"),b=document.querySelector(".marker-time"),E=f;function x(e,t){var n=parseInt(100*(e/t));m.innerHTML=n}function M(){t?p.setAttribute("class","container container-picture"):p.setAttribute("class","container container-video"),v.pow=v.end=0,0,i=null,f.pause(),h.addEventListener("mousedown",R,W),window.addEventListener("mousedown",_,W),window.addEventListener("mousemove",U,W),window.addEventListener("mouseup",Y,W),window.addEventListener("mouseleave",Y,W),p.addEventListener("wheel",F),h.addEventListener("touchstart",R,W),window.addEventListener("touchstart",z,W),window.addEventListener("touchmove",U,W),window.addEventListener("touchend",Y,W),window.onscroll=X,window.requestAnimationFrame(k),T(1)}function T(o){L.filter(function(e,t){var n=c[t]-v.pow*E.duration;2<Math.abs(n)?e.setAttribute("class","captions-item"):0<o?e.setAttribute("class","captions-item "+(-.1<n?"entering":"exiting")):o<0&&e.setAttribute("class","captions-item "+(n<.1?"entering":"exiting"))})}t?(p.setAttribute("class","container container-picture loading"),(E=w).currentTime=0,E.duration=o,E.play=E.pause=function(){},E.setTime=function(){var e=Math.max(1,Math.min(u,Math.round(E.currentTime*a)));E.index!==e&&(E.index=e,E.src=d[e])},function(){var o=u,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);d[n]=t,r++,i.shift(),x(r,o),r===o?(E.setTime(),M()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(p.setAttribute("class","container container-video loading"),(E=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=t;var n=f.play();void 0!==n?n.then(function(){M()}).catch(function(e){console.log("video.error",e,f.error)}):M()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var S=window.peformance?performance:Date,A=1e3/a,q=0,H=0,P=0;function k(){q=S.now(),A<(P=q-H)&&(H=q-P%A,function(){if(E.duration){if(i)v.pow=v.end,E.pause(),E.currentTime=v.pow*E.duration,E.setTime();else if(v.end!==v.pow){E.paused||E.pause();var e=v.end-v.pow,t=1/a;if(Math.abs(e*E.duration)<t)v.pow=v.end;else{var n=e?e/Math.abs(e):0;v.pow+=t*n/E.duration}var o=Math.round(v.pow*E.duration/t)*t+1e-5;E.currentTime=o,E.setTime()}var r=h.offsetHeight;y.setAttribute("style","top:"+E.currentTime/E.duration*r+"px;"),T(v.direction)}}()),requestAnimationFrame(k)}function R(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&C(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function I(e){return e.clientY||e.touches[0].pageY}function j(e){var t=!1;return(v.pow<1&&1===e||r.offset.y<10&&-1===e)&&(t=!0),console.log("shouldLockScroll",t,e,v.pow,r.offset.y,e),t}var D,G=0;function O(e){if(r.offset.y<10){var t=I(e);i=t,G=v.end||0}}function U(e){if(i){var t=I(e);if(D=t,1<Math.abs(i-t)){var n=(i-t)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,G+n))}if(j(0<t-i?-1:1))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}function Y(e){if(i){var t=i-D;if(t){i=null;var n=t/Math.abs(t),o=v.end*E.duration;c.filter(function(e,t){e<o&&o<c[t+1]&&(v.index=t+(0<n?0:1))}),N(n)}}}function F(e){var t=e.deltaY/Math.abs(e.deltaY);if(N(t),j(t))return e.preventDefault(),e.stopImmediatePropagation(),!1}function X(){var e=h.offsetHeight;b.setAttribute("style","top : "+v.end*(e-30)+"px;")}function C(e){if(e!==v.index){var t=(e-v.index)/Math.abs(e-v.index),n=c[v.index],o=c[e],r=v.pow*E.duration;if(r>=Math.min(n,o)&&r<=Math.max(n,o)){v.index=e,v.endTime=c[v.index],v.direction=t,v.end=v.endTime/E.duration;var i=h.offsetHeight;b.setAttribute("style","top : "+v.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function N(e){v.index;C(1===e?Math.min(c.length-1,v.index+1):Math.max(0,v.index-1))}var W=window.PointerEvent?{passive:!1,capture:!0}:void 0;function _(e){h.removeEventListener("touchstart",R),window.removeEventListener("touchstart",z),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",Y),console.log("removeTouchEvents"),O(e)}function z(e){h.removeEventListener("mousedown",R),window.removeEventListener("mousedown",_),window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",Y),window.removeEventListener("mouseleave",Y),console.log("removeMouseEvents"),O(e)}}();
//# sourceMappingURL=app.min.js.map
