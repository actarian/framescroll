!function(){"use strict";var r,e,t=!1,a="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",s=25,d=498,o=d/s,c=[0,2.14,5.22,9.16,12.13,16.08,o],u=[],l=15,v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},m=document.querySelector(".container"),f=document.querySelector(".content"),i=document.querySelector(".preload"),p=document.querySelector(".video"),w=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=document.querySelector(".circle-time"),E=document.querySelector(".circle-scroll"),T=p;function x(e,t){var n=parseInt(100*(e/t));i.innerHTML=n}function M(){t?m.setAttribute("class","container container-picture"):m.setAttribute("class","container container-video"),v.pow=v.end=0,0,r=null,p.pause(),h.addEventListener("mousedown",k),window.addEventListener("mousedown",N),window.addEventListener("mousemove",Y),window.addEventListener("mouseup",D),window.addEventListener("mouseleave",D),window.addEventListener("wheel",F),h.addEventListener("touchstart",k),window.addEventListener("touchstart",P),window.addEventListener("touchmove",Y),window.addEventListener("touchend",D),window.onscroll=G,window.requestAnimationFrame(H)}t?(m.setAttribute("class","container container-picture loading"),(T=w).currentTime=0,T.duration=o,T.play=T.pause=function(){},T.setTime=function(){var e=Math.max(1,Math.min(d,Math.round(T.currentTime*s)));T.index!==e&&(T.index=e,T.src=u[e])},function(){var o=d,i=0,e=0,r=[];function s(){for(;r.length<l&&e<o;)r.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",a.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);u[n]=t,i++,r.shift(),x(i,o),i===o?(T.setTime(),M()):s()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}s()}()):(m.setAttribute("class","container container-video loading"),(T=p).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);p.addEventListener("progress",function(e){console.log("video.progress",e,p.duration)},!1),p.addEventListener("error",function(e){console.log("video.error",e,p.error)}),p.autoplay=!0,p.mute=!0,p.src=t;var n=p.play();void 0!==n?n.then(function(){M()}).catch(function(e){console.log("video.error",e,p.error)}):M()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var y=window.peformance?performance:Date,b=1e3/s,q=0,S=0,A=0;function H(){q=y.now(),b<(A=q-S)&&(S=q-A%b,function(){if(T.duration){if(r)v.pow=v.end,T.pause(),T.currentTime=v.pow*T.duration,T.setTime();else if(v.end!==v.pow){T.paused||T.pause();var e=v.end-v.pow,t=1/s;if(Math.abs(e*T.duration)<t)v.pow=v.end;else{var n=e?e/Math.abs(e):0;v.pow+=t*n/T.duration}var o=Math.round(v.pow*T.duration/t)*t+1e-5;T.currentTime=o,T.setTime()}var i=m.offsetHeight;f.offsetHeight,L.setAttribute("style","top:"+(15+T.currentTime/T.duration*(i-30))+"px;")}}()),requestAnimationFrame(H)}function k(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&O(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function R(e){return e.clientY||e.touches[0].pageY}var j=0;function U(e){var t=R();r=t,j=v.end||0,console.log("onDown",r,j)}function Y(e){if(r){var t=R();if(1<Math.abs(r-t)){var n=(r-t)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,j+n)),X()}}}function D(e){if(r){var t=R(),n=r-t;if(console.log(t,r,n),n){r=null;var o=n/Math.abs(n),i=v.end*T.duration;c.filter(function(e,t){e<i&&i<c[t+1]&&(v.index=t+(0<o?0:1))}),I(o),X()}}}function F(e){I(e.deltaY/Math.abs(e.deltaY)),X()}function G(){var e=m.offsetHeight;E.setAttribute("style","top : "+(15+v.end*(e-30))+"px;")}function O(e){if(e!==v.index){var t=(e-v.index)/Math.abs(e-v.index),n=c[v.index],o=c[e],i=v.pow*T.duration;if(i>=Math.min(n,o)&&i<=Math.max(n,o)){v.index=e,v.endTime=c[v.index],v.direction=t,v.end=v.endTime/T.duration;var r=m.offsetHeight;E.setAttribute("style","top : "+(15+v.end*(r-30))+"px;"),$(".slick").slick("slickGoTo",e)}}}function I(e){v.index;O(1===e?Math.min(c.length-1,v.index+1):Math.max(0,v.index-1))}function X(){var e=m.offsetHeight,t=f.offsetHeight-e,n=v.end*t;window.scrollTo(0,Math.max(0,Math.min(t,n)))}function N(e){h.removeEventListener("touchstart",k),window.removeEventListener("touchstart",P),window.removeEventListener("touchmove",Y),window.removeEventListener("touchend",D),console.log("removeTouchEvents"),U()}function P(e){h.removeEventListener("mousedown",k),window.removeEventListener("mousedown",N),window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",D),window.removeEventListener("mouseleave",D),window.removeEventListener("wheel",F),console.log("removeMouseEvents"),U()}$(document).ready(function(){$(".slick").slick({infinite:!1,slidesToShow:1,slidesToScroll:1,vertical:!0,arrows:!1,dots:!1,swipe:!1,swipeToSlide:!1,verticalSwiping:!1})})}();
//# sourceMappingURL=app.min.js.map
