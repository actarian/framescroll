!function(){"use strict";Element.prototype.hasClass=function(e){return new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)").test(this.className)},Element.prototype.addClass=function(e){this.hasClass(e)||(this.className=this.className?this.className+" "+e:e)},Element.prototype.removeClass=function(e){this.hasClass(e)&&(this.className=this.className.split(e).join("").replace(/\s\s+/g," "))},Element.prototype.isDescendant=function(e){return function e(t,n){return t===n||!!t.parentNode&&e(t.parentNode,n)}(this,e)},window.getMouse=function(e){var t=0;t=e.touches?e.touches[0].pageY:e.clientY;return{x:e.touches?e.touches[0].pageX:e.clientX,y:t}}}(),function(){"use strict";var t=document.querySelector(".form-group-multiple");function e(){t.addClass("active")}function n(e){e.target.isDescendant(t)||t.removeClass("active")}t.addEventListener("mousedown",e),t.addEventListener("touchstart",e),window.addEventListener("mousedown",n),window.addEventListener("touchstart",n);var o=document.querySelector(".nav-container");Scrollbar.use(window.OverscrollPlugin);Scrollbar.init(o,{plugins:{overscroll:{}}});var i=Array.prototype.slice.call(document.querySelectorAll(".nav-multiple li"));i.filter(function(o,e){function t(e){var t,n;o.active=!o.active,o.active?o.addClass("active"):o.removeClass("active"),t=i.filter(function(e){return e.active}).map(function(e){return e.querySelector("span").innerHTML}),(n=document.querySelector('input[name="Brands"]')).value=0<t.length?t.join(", "):null,console.log("setValue",t,n.value)}function n(e){o.removeEventListener("touchstart",r),t()}function r(e){o.removeEventListener("mousedown",n),t()}o.addEventListener("mousedown",n),o.addEventListener("touchstart",r)})}(),function(){"use strict";/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);var r,e=!1,s=30,n=1200,o=n/s,u=15,c={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},a=document.querySelector("body"),l=document.querySelector(".page"),t=document.querySelector(".section-overview"),i=document.querySelector(".preload .percent"),d=document.querySelector(".track"),p=document.querySelector(".steps"),m=document.querySelector(".player-time"),v=document.querySelector(".marker-time"),f=Array.prototype.slice.call(document.querySelectorAll("[scroll-to]")),y=Array.prototype.slice.call(document.querySelectorAll("[data-marker]")).map(function(e,t){return e.addEventListener("click",function(){B(t,!0);var e=1/x.player.duration;c.pow=c.end-e}),parseFloat(e.getAttribute("data-marker"))});console.log("markers",y);var w={source:{jpg:"img/campagnolo/campagnolo_{0}.jpg",webm:"img/campagnolo.webm",mp4:"img/disc/disc.mp4",check:"img/Chrome_ImF.webm"},video:document.querySelector(".overview-disc .video"),pictures:document.querySelector(".overview-disc .pictures"),captionItems:Array.prototype.slice.call(document.querySelectorAll(".overview-disc .captions-item")),images:[]},g={source:{jpg:"img/campagnolo/campagnolo_{0}.jpg",webm:"img/campagnolo.webm",mp4:"img/rim/rim.mp4",check:"img/Chrome_ImF.webm"},video:document.querySelector(".overview-rim .video"),pictures:document.querySelector(".overview-rim .pictures"),captionItems:Array.prototype.slice.call(document.querySelectorAll(".overview-rim .captions-item")),images:[]},x=null,h=function(){Scrollbar.use(window.OverscrollPlugin);var t=Scrollbar.init(l,{plugins:{overscroll:{}}});return t.addListener(function(i){i.offset,i.limit,l.offsetWidth,l.offsetHeight,L||(0<i.offset.y?a.addClass("submenu"):a.removeClass("submenu"));var e=f.filter(function(e,t){var n=e.getAttribute("href"),o=document.querySelector(n);if(e.removeClass("active"),o){var r=o.offsetTop-i.offset.y;return e.top=r,!0}return!1}).reduce(function(e,t){return Math.abs(e.top)<Math.abs(t.top)?e:t});e&&e.addClass("active")}),t.onScrollbarShouldScrollTo=function(e){document.querySelector(e.selector)===l&&t.scrollTo(e.x||0,e.y||0,500)},t}(),b=!1,L=!1,E=!1;function S(){a.addClass("loading"),b=!0,e?(a.addClass("use-pictures"),w.player=w.pictures,w.player.currentTime=0,w.player.duration=o,w.player.play=w.player.pause=function(){},w.player.setTime=function(){var e=Math.max(1,Math.min(n,Math.round(w.player.currentTime*s)));w.player.index!==e&&(w.player.index=e,w.player.src=w.images[e])},g.player=g.pictures,g.player.currentTime=0,g.player.duration=o,g.player.play=g.player.pause=function(){},g.player.setTime=function(){var e=Math.max(1,Math.min(n,Math.round(g.player.currentTime*s)));g.player.index!==e&&(g.player.index=e,g.player.src=g.images[e])},function(){var o=n,r=0,e=0,i=[];function a(){for(;i.length<u&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",x.source.jpg.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);images[n]=t,r++,i.shift(),A(r,o),r===o?(x.player.setTime(),T()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(a.addClass("use-video"),w.player=w.video,w.player.setTime=function(){},g.player=g.video,g.player.setTime=function(){},q(w,function(){q(g,function(){M()})}))}function A(e,t){var n=parseInt(100*(e/t));i&&i.setAttribute("style","width:"+n+"%;")}function M(){var e=x.video.play();void 0!==e?e.then(function(){T()}).catch(function(e){console.log("video.error",e,x.video.error)}):T()}function q(n,o){var e=new XMLHttpRequest;e.open("GET",n.source.mp4,!0),e.responseType="blob",e.onprogress=function(e){A(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);n.video.addEventListener("progress",function(e){console.log("video.progress",e,n.video.duration)},!1),n.video.addEventListener("error",function(e){console.log("video.error",e,n.video.error)}),n.video.autoplay=!0,n.video.mute=!0,n.video.src=t,o&&o()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}function T(){L=!(b=!1),a.removeClass("loading"),a.addClass("loaded"),a.addClass("submenu"),c.pow=c.end=0,0,r=null,x.video.pause(),p&&function(){for(var e=0;e<y.length;e++){var t='<div class="step" style="top:'+(y[e]/o*100).toFixed(3)+'%"></div>';p.innerHTML+=t}}(),function(){d&&d.addEventListener("mousedown",N,$);t.addEventListener("mousedown",J,$),t.addEventListener("mousemove",G,$),t.addEventListener("wheel",_),window.addEventListener("mouseup",W,$)}(),function(){d&&d.addEventListener("touchstart",N,$);t.addEventListener("touchstart",K,$),t.addEventListener("touchmove",G,$),t.addEventListener("touchend",W,$)}(),window.onscroll=z,window.requestAnimationFrame(D),B(1)}function C(e){if(e.player.duration){if(Y)e.player.pause(),c.pow=c.end,e.player.currentTime=c.pow*e.player.duration,e.player.setTime();else if(c.end!==c.pow){e.player.paused||e.player.pause();var t=c.end-c.pow,n=1/s;if(Math.abs(t*e.player.duration)<n)c.pow=c.end;else{var o=t?t/Math.abs(t):0;c.pow+=n*o/e.player.duration}var r=Math.round(c.pow*e.player.duration/n)*n+1e-5;e.player.currentTime=r,e.player.setTime()}if(m){var i=d.offsetHeight-20;m.setAttribute("style","top:"+e.player.currentTime/e.player.duration*i+"px;")}a=c.direction,x.captionItems.filter(function(e,t){var n=y[t]-c.pow*x.player.duration;2<Math.abs(n)?e.setAttribute("class","captions-item"):0<a?e.setAttribute("class","captions-item "+(-.1<n?"entering":"exiting")):a<0&&e.setAttribute("class","captions-item "+(n<.1?"entering":"exiting"))})}var a}var P=window.peformance?performance:Date,I=1e3/s,k=0,H=0,j=0;function D(){k=P.now(),I<(j=k-H)&&(H=k-j%I,C(w),C(g)),requestAnimationFrame(D)}function N(e){if(!E){if(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))B(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}}function F(e){var t=0;return t=e.touches?e.touches[0].pageY:e.clientY,Math.max(0,Math.min(window.innerHeight,t))}function R(e){var t=!1;return(c.pow<1&&1===e||(!h||h.offset.y<10)&&-1===e)&&(t=!0),t}var X,Y=!1,O=0;function U(e){if(h.offset.y<10){var t=F(e);X=null,r=t,O=c.end||0}}function G(e){if(E)r=X=null;else if(r){var t=F(e);if(X=t,1<Math.abs(r-t)){var n=(r-t)/(3*window.innerHeight);c.end=Math.max(0,Math.min(1,O+n)),Y=!0}if(R(0<t-r?-1:1))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}function W(e){if(Y){var t=r-X;if(t){var n=t/Math.abs(t),o=c.end*x.player.duration;y.filter(function(e,t){e<o&&o<y[t+1]&&(c.index=t+(0<n?0:1))}),V(n)}}Y=!1,r=null}function _(e){var t=e.deltaY/Math.abs(e.deltaY);if(V(t),R(t))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}function z(){if(v){var e=d.offsetHeight-20;v.setAttribute("style","top : "+c.end*e+"px;")}}function B(n,e){if(n!==c.index){var t=(n-c.index)/Math.abs(n-c.index),o=y[c.index],r=y[n],i=c.pow*x.player.duration;if((e||i>=Math.min(o,r)&&i<=Math.max(o,r))&&(c.index=n,c.endTime=y[c.index],c.direction=t,c.end=c.endTime/x.player.duration,v)){var a=d.offsetHeight-20;v.setAttribute("style","top : "+c.end*a+"px;")}console.log("setIndex",n),Array.prototype.slice.call(document.querySelectorAll("[data-marker]")).filter(function(e,t){n===t?e.addClass("active"):e.removeClass("active")})}}function V(e){c.index;B(1===e?Math.min(y.length-1,c.index+1):Math.max(0,c.index-1))}var $=window.PointerEvent?{passive:!1,capture:!0}:void 0;function J(e){!function(){d&&d.removeEventListener("touchstart",N);t.removeEventListener("touchstart",K),t.removeEventListener("touchmove",G),t.removeEventListener("touchend",W)}(),U(e)}function K(e){!function(){d&&d.removeEventListener("mousedown",N);t.removeEventListener("mousedown",J),t.removeEventListener("mousemove",G),window.removeEventListener("mouseup",W)}(),U(e)}var Q,Z,ee=Array.prototype.slice.call(document.querySelectorAll("img.svg"));ee=ee.map(function(n){var o=n.getAttribute("class"),e=n.getAttribute("src"),t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="text",t.onload=function(){if(200===this.status){var e=n.parentNode;e.innerHTML=this.responseText;var t=e.querySelector("svg");console.log(t),t.setAttribute("class",o),t.setAttribute("xmlns:a",null)}},t.onerror=function(e){console.log("svg.error",e)},t.send()}),f.filter(function(r,e){r.addEventListener("click",function(e){var t=r.getAttribute("href"),n=document.querySelector(t);if(n){var o=n.offsetTop;h.scrollTo(0,o,600,{callback:function(){console.log("ScrollTo.complete",o)}})}return e.preventDefault(),e.stopImmediatePropagation(),!1})}),Q=document.querySelector(".overview-logo"),Z={x:0,y:0},function e(){Q.setAttribute("style","transform: rotateX("+4*Z.y+"deg) rotateY("+20*Z.x+"deg);"),requestAnimationFrame(e)}(),window.addEventListener("mousemove",function(e){Z.x=e.clientX/window.innerWidth-.5,Z.y=e.clientY/window.innerHeight-.5}),function(){var a,o,r,e=document.querySelector(".overview-switch"),i=document.querySelector(".switch-slider"),s=document.querySelector(".overview-disc"),u=document.querySelector(".overview-rim"),c=s.querySelector(".cover"),l=u.querySelector(".cover"),d=i.offsetWidth,p={x:0,y:0},n={x:0,y:0},m=50;function v(){i.setAttribute("style","transform: translateX("+p.x*d/2+"px)");var e=function(e){e=e/2+.5;var t=100*(e=Math.min(1,Math.max(0,e)));return Math.abs(t-m)<.1?m=t:m+=(t-m)/20,{rim:"polygon("+t+"% 0, 100% 0, 100% 100%, "+m+"% 100%)",disc:"polygon(0 0, "+t+"0.01% 0, "+m+"0.01% 100%, 0 100%)"}}(p.x);s.setAttribute("style","shape-inside: "+e.disc+"; clip-path: "+e.disc+"; -webkit-clip-path: "+e.disc+";"),u.setAttribute("style","shape-inside: "+e.rim+"; clip-path: "+e.rim+"; -webkit-clip-path: "+e.rim+";");var t=1.1-(p.x+1)/2*.1,n=1+(p.x+1)/2*.1,o=20*(p.x<0?Math.abs(p.x):0)+"px",r=20*(0<p.x?Math.abs(p.x):0)+"px";c.setAttribute("style","transform: scale("+t+"); filter: blur("+o+");"),l.setAttribute("style","transform: scale("+n+"); filter: blur("+r+");")}function t(e){if(!b)return E=!0,n.x=p.x,n.y=p.y,o=getMouse(e),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}function f(e){if(o){r=getMouse(e);var t=n.x+(r.x-o.x)/(d/2);return t=Math.max(-1,Math.min(1,t)),a=t>p.x?1:-1,p.x=t,v(),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}!function e(){v(),requestAnimationFrame(e)}(),window.addEventListener("mousemove",f);var y=[-1,0,1];function h(e){if(r){o=r=null;var t=y.reduce(function(e,t){return Math.abs(e-p.x)<Math.abs(t-p.x)?e:t}),n=!1;0!==t&&3===y.length&&(y=[-1,1],n=!0),2==y.length&&(x=-1===t?g:w),a=t>p.x?1:-1,TweenLite.to(p,1,{x:t,ease:Elastic.easeOut,onUpdate:v,onComplete:function(){n&&S()}})}E=!1,window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",h),window.removeEventListener("touchmove",f),window.removeEventListener("touchend",h)}e.addEventListener("mousedown",function(e){t(e),window.addEventListener("mousemove",f),window.addEventListener("mouseup",h)}),e.addEventListener("touchstart",function(e){t(e),window.addEventListener("touchmove",f),window.addEventListener("touchend",h)}),window.addEventListener("resize",function(){d=i.offsetWidth,v()}),Array.prototype.slice.call(document.querySelectorAll(".btn-overview")).filter(function(t,n){function o(e){return b||(a=1===n?1:-1,x=1===n?w:g,y=[-1,1],TweenLite.to(p,1,{x:a,ease:Elastic.easeOut,onUpdate:v,onComplete:function(){L||S()}})),e.preventDefault(),e.stopImmediatePropagation(),!1}function r(e){t.removeEventListener("touchstart",i),o(e)}function i(e){t.removeEventListener("mousedown",r),o(e)}t.addEventListener("mousedown",r),t.addEventListener("touchstart",i)})}()}();
//# sourceMappingURL=app.min.js.map
