!function(){"use strict";var i,e,t=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,n=(/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),!1),s="img/campagnolo/campagnolo_{0}.jpg",o=t?"img/campagnolo2.mp4":"img/campagnolo.webm",a=25,c=498,r=c/a,d=[0,2.14,5.22,9.16,12.13,16.08,r],u=[],l=15,v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},m=document.querySelector(".container"),f=document.querySelector(".preload"),p=document.querySelector(".video"),w=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=document.querySelector(".circle-time"),b=document.querySelector(".circle-scroll"),E=p;function T(e,t){var n=parseInt(100*(e/t));f.innerHTML=n}function x(){n?m.setAttribute("class","container container-picture"):m.setAttribute("class","container container-video"),v.pow=v.end=0,0,i=null,p.pause(),h.addEventListener("mousedown",R),window.addEventListener("mousedown",D),window.addEventListener("mousemove",O),window.addEventListener("mouseup",U),window.addEventListener("mouseleave",U),window.addEventListener("wheel",Y),h.addEventListener("touchstart",R),window.addEventListener("touchstart",X),window.addEventListener("touchmove",O),window.addEventListener("touchend",U),window.onscroll=F,window.requestAnimationFrame(H)}n?(m.setAttribute("class","container container-picture loading"),(E=w).currentTime=0,E.duration=r,E.play=E.pause=function(){},E.setTime=function(){var e=Math.max(1,Math.min(c,Math.round(E.currentTime*a)));E.index!==e&&(E.index=e,E.src=u[e])},function(){var o=c,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);u[n]=t,r++,i.shift(),T(r,o),r===o?(E.setTime(),x()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(m.setAttribute("class","container container-video loading"),(E=p).setTime=function(){},(e=new XMLHttpRequest).open("GET",o,!0),e.responseType="blob",e.onprogress=function(e){T(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);p.addEventListener("progress",function(e){console.log("video.progress",e,p.duration)},!1),p.addEventListener("error",function(e){console.log("video.error",e,p.error)}),p.autoplay=!0,p.mute=!0,p.src=t;var n=p.play();void 0!==n?n.then(function(){x()}).catch(function(e){console.log("video.error",e,p.error)}):x()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<d.length;e++){var t='<div class="step" style="top:'+(d[e]/r*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var y=window.peformance?performance:Date,M=1e3/a,S=0,q=0,A=0;function H(){S=y.now(),M<(A=S-q)&&(q=S-A%M,function(){if(E.duration){if(i)v.pow=v.end,E.pause(),E.currentTime=v.pow*E.duration,E.setTime();else if(v.end!==v.pow){E.paused||E.pause();var e=v.end-v.pow,t=1/a;if(Math.abs(e*E.duration)<t)v.pow=v.end;else{var n=e?e/Math.abs(e):0;v.pow+=t*n/E.duration}var o=Math.round(v.pow*E.duration/t)*t+1e-5;E.currentTime=o,E.setTime()}var r=h.offsetHeight;L.setAttribute("style","top:"+E.currentTime/E.duration*r+"px;")}}()),requestAnimationFrame(H)}function R(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&I(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function P(e){return e.clientY||e.touches[0].pageY}var j,k=0;function G(e){var t=P(e);i=t,k=v.end||0}function O(e){if(i){var t=P(e);if(j=t,1<Math.abs(i-t)){var n=(i-t)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,k+n))}}}function U(e){if(i){var t=i-j;if(t){i=null;var n=t/Math.abs(t),o=v.end*E.duration;d.filter(function(e,t){e<o&&o<d[t+1]&&(v.index=t+(0<n?0:1))}),C(n)}}}function Y(e){C(e.deltaY/Math.abs(e.deltaY))}function F(){var e=h.offsetHeight;b.setAttribute("style","top : "+v.end*(e-30)+"px;")}function I(e){if(e!==v.index){var t=(e-v.index)/Math.abs(e-v.index),n=d[v.index],o=d[e],r=v.pow*E.duration;if(r>=Math.min(n,o)&&r<=Math.max(n,o)){v.index=e,v.endTime=d[v.index],v.direction=t,v.end=v.endTime/E.duration;var i=h.offsetHeight;b.setAttribute("style","top : "+v.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function C(e){v.index;I(1===e?Math.min(d.length-1,v.index+1):Math.max(0,v.index-1))}function D(e){h.removeEventListener("touchstart",R),window.removeEventListener("touchstart",X),window.removeEventListener("touchmove",O),window.removeEventListener("touchend",U),console.log("removeTouchEvents"),G(e)}function X(e){h.removeEventListener("mousedown",R),window.removeEventListener("mousedown",D),window.removeEventListener("mousemove",O),window.removeEventListener("mouseup",U),window.removeEventListener("mouseleave",U),window.removeEventListener("wheel",Y),console.log("removeMouseEvents"),G(e)}!function(){var n=document.querySelector(".page");Scrollbar.use(window.OverscrollPlugin);var t=Scrollbar.init(n,{plugins:{overscroll:{}}});t.addListener(function(e){var t={offset:e.offset,limit:e.limit,container:{width:n.offsetWidth,height:n.offsetHeight}};console.log("Scrollbar.onChange",t)}),t.onScrollbarShouldScrollTo=function(e){console.log("Scrollbar.onScrollbarShouldScrollTo",e),document.querySelector(e.selector)===n&&t.scrollTo(e.x||0,e.y||0,500)}}()}();
//# sourceMappingURL=app.min.js.map
