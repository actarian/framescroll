!function(){"use strict";var i,e,n=!1,s="img/campagnolo/campagnolo_{0}.jpg",t="img/campagnolo2.mp4",a=25,c=498,o=c/a,d=[0,2.14,5.22,9.16,12.13,16.08,o],u=[],l=15,v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},r=document.querySelector(".container"),m=document.querySelector(".preload"),f=document.querySelector(".video"),p=document.querySelector(".picture"),w=document.querySelector(".track"),h=document.querySelector(".steps"),g=document.querySelector(".circle-time"),L=document.querySelector(".circle-scroll"),b=f;function E(e,n){var t=parseInt(100*(e/n));m.innerHTML=t}function T(){n?r.setAttribute("class","container container-picture"):r.setAttribute("class","container container-video"),v.pow=v.end=0,0,i=null,f.pause(),w.addEventListener("mousedown",H),window.addEventListener("mousedown",P),window.addEventListener("mousemove",U),window.addEventListener("mouseup",Y),window.addEventListener("mouseleave",Y),window.addEventListener("wheel",F),w.addEventListener("touchstart",H),window.addEventListener("touchstart",X),window.addEventListener("touchmove",U),window.addEventListener("touchend",Y),window.onscroll=G,window.requestAnimationFrame(A)}n?(r.setAttribute("class","container container-picture loading"),(b=p).currentTime=0,b.duration=o,b.play=b.pause=function(){},b.setTime=function(){var e=Math.max(1,Math.min(c,Math.round(b.currentTime*a)));b.index!==e&&(b.index=e,b.src=u[e])},function(){var o=c,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),n(++e)}function n(t){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(t),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,n=URL.createObjectURL(e);u[t]=n,r++,i.shift(),E(r,o),r===o?(b.setTime(),T()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(r.setAttribute("class","container container-video loading"),(b=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",t,!0),e.responseType="blob",e.onprogress=function(e){E(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,n=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=n;var t=f.play();void 0!==t?t.then(function(){T()}).catch(function(e){console.log("video.error",e,f.error)}):T()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<d.length;e++){var n='<div class="step" style="top:'+(d[e]/o*100).toFixed(3)+'%"></div>';h.innerHTML+=n}}();var x=window.peformance?performance:Date,y=1e3/a,M=0,S=0,q=0;function A(){M=x.now(),y<(q=M-S)&&(S=M-q%y,function(){if(b.duration){if(i)v.pow=v.end,b.pause(),b.currentTime=v.pow*b.duration,b.setTime();else if(v.end!==v.pow){b.paused||b.pause();var e=v.end-v.pow,n=1/a;if(Math.abs(e*b.duration)<n)v.pow=v.end;else{var t=e?e/Math.abs(e):0;v.pow+=n*t/b.duration}var o=Math.round(v.pow*b.duration/n)*n+1e-5;b.currentTime=o,b.setTime()}var r=w.offsetHeight;g.setAttribute("style","top:"+b.currentTime/b.duration*r+"px;")}}()),requestAnimationFrame(A)}function H(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&D(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function R(e){return e.clientY||e.touches[0].pageY}var j,k=0;function O(e){var n=R(e);i=n,k=v.end||0}function U(e){if(i){var n=R(e);if(j=n,1<Math.abs(i-n)){var t=(i-n)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,k+t))}}}function Y(e){if(i){var n=i-j;if(n){i=null;var t=n/Math.abs(n),o=v.end*b.duration;d.filter(function(e,n){e<o&&o<d[n+1]&&(v.index=n+(0<t?0:1))}),I(t)}}}function F(e){I(e.deltaY/Math.abs(e.deltaY))}function G(){var e=w.offsetHeight;L.setAttribute("style","top : "+v.end*(e-30)+"px;")}function D(e){if(e!==v.index){var n=(e-v.index)/Math.abs(e-v.index),t=d[v.index],o=d[e],r=v.pow*b.duration;if(r>=Math.min(t,o)&&r<=Math.max(t,o)){v.index=e,v.endTime=d[v.index],v.direction=n,v.end=v.endTime/b.duration;var i=w.offsetHeight;L.setAttribute("style","top : "+v.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function I(e){v.index;D(1===e?Math.min(d.length-1,v.index+1):Math.max(0,v.index-1))}function P(e){w.removeEventListener("touchstart",H),window.removeEventListener("touchstart",X),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",Y),console.log("removeTouchEvents"),O(e)}function X(e){w.removeEventListener("mousedown",H),window.removeEventListener("mousedown",P),window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",Y),window.removeEventListener("mouseleave",Y),window.removeEventListener("wheel",F),console.log("removeMouseEvents"),O(e)}!function(){var t=document.querySelector(".page");Scrollbar.use(window.OverscrollPlugin);var n=Scrollbar.init(t,{plugins:{overscroll:{}}});n.addListener(function(e){var n={offset:e.offset,limit:e.limit,container:{width:t.offsetWidth,height:t.offsetHeight}};console.log("Scrollbar.onChange",n)}),n.onScrollbarShouldScrollTo=function(e){console.log("Scrollbar.onScrollbarShouldScrollTo",e),document.querySelector(e.selector)===t&&n.scrollTo(e.x||0,e.y||0,500)}}()}();
//# sourceMappingURL=app.min.js.map
