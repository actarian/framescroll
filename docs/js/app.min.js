!function(){"use strict";var r,e,t=!1,a="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",s=25,d=498,o=d/s,c=[0,2.14,5.22,9.16,12.13,16.08,o],u=[],l=15,v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},m=document.querySelector(".container"),p=document.querySelector(".content"),i=document.querySelector(".preload"),f=document.querySelector(".video"),w=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=document.querySelector(".circle-time"),E=document.querySelector(".circle-scroll"),T=f;function x(e,t){var n=parseInt(100*(e/t));i.innerHTML=n}function M(){t?m.setAttribute("class","container container-picture"):m.setAttribute("class","container container-video"),v.pow=v.end=0,0,r=null,f.pause(),h.addEventListener("mousedown",Y),window.addEventListener("mousedown",X),window.addEventListener("mousemove",j),window.addEventListener("mouseup",U),window.addEventListener("mouseleave",U),window.addEventListener("wheel",D),h.addEventListener("touchstart",Y),window.addEventListener("touchstart",N),window.addEventListener("touchmove",j),window.addEventListener("touchend",U),window.onscroll=F,window.requestAnimationFrame(H)}t?(m.setAttribute("class","container container-picture loading"),(T=w).currentTime=0,T.duration=o,T.play=T.pause=function(){},T.setTime=function(){var e=Math.max(1,Math.min(d,Math.round(T.currentTime*s)));T.index!==e&&(T.index=e,T.src=u[e])},function(){var o=d,i=0,e=0,r=[];function s(){for(;r.length<l&&e<o;)r.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",a.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);u[n]=t,i++,r.shift(),x(i,o),i===o?(T.setTime(),M()):s()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}s()}()):(m.setAttribute("class","container container-video loading"),(T=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=t;var n=f.play();void 0!==n?n.then(function(){M()}).catch(function(e){console.log("video.error",e,f.error)}):M()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var y=window.peformance?performance:Date,b=1e3/s,q=0,S=0,A=0;function H(){q=y.now(),b<(A=q-S)&&(S=q-A%b,function(){if(T.duration){if(r)v.pow=v.end,T.pause(),T.currentTime=v.pow*T.duration,T.setTime();else if(v.end!==v.pow){T.paused||T.pause();var e=v.end-v.pow,t=1/s;if(Math.abs(e*T.duration)<t)v.pow=v.end;else{var n=e?e/Math.abs(e):0;v.pow+=t*n/T.duration}var o=Math.round(v.pow*T.duration/t)*t+1e-5;T.currentTime=o,T.setTime()}var i=m.offsetHeight;p.offsetHeight,L.setAttribute("style","top:"+(15+T.currentTime/T.duration*(i-30))+"px;")}}()),requestAnimationFrame(H)}function Y(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&G(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}var k=0;function R(e){r=e.clientY,k=v.end||0,console.log("onDown",r,k)}function j(e){if(r&&1<Math.abs(r-e.clientY)){var t=(r-e.clientY)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,k+t)),I()}}function U(e){if(r){var t=r-e.clientY;if(console.log(e.clientY,r,t),t){r=null;var n=t/Math.abs(t),o=v.end*T.duration;c.filter(function(e,t){e<o&&o<c[t+1]&&(v.index=t+(0<n?0:1))}),O(n),I()}}}function D(e){O(e.deltaY/Math.abs(e.deltaY)),I()}function F(){var e=m.offsetHeight;E.setAttribute("style","top : "+(15+v.end*(e-30))+"px;")}function G(e){if(e!==v.index){var t=(e-v.index)/Math.abs(e-v.index),n=c[v.index],o=c[e],i=v.pow*T.duration;if(i>=Math.min(n,o)&&i<=Math.max(n,o)){v.index=e,v.endTime=c[v.index],v.direction=t,v.end=v.endTime/T.duration;var r=m.offsetHeight;E.setAttribute("style","top : "+(15+v.end*(r-30))+"px;"),$(".slick").slick("slickGoTo",e)}}}function O(e){v.index;G(1===e?Math.min(c.length-1,v.index+1):Math.max(0,v.index-1))}function I(){var e=m.offsetHeight,t=p.offsetHeight-e,n=v.end*t;window.scrollTo(0,Math.max(0,Math.min(t,n)))}function X(e){h.removeEventListener("touchstart",Y),window.removeEventListener("touchstart",N),window.removeEventListener("touchmove",j),window.removeEventListener("touchend",U),console.log("removeTouchEvents"),R(e)}function N(e){h.removeEventListener("mousedown",Y),window.removeEventListener("mousedown",X),window.removeEventListener("mousemove",j),window.removeEventListener("mouseup",U),window.removeEventListener("mouseleave",U),window.removeEventListener("wheel",D),console.log("removeMouseEvents"),R(e)}$(document).ready(function(){$(".slick").slick({infinite:!1,slidesToShow:1,slidesToScroll:1,vertical:!0,arrows:!1,dots:!1,swipe:!1,swipeToSlide:!1,verticalSwiping:!1})})}();
//# sourceMappingURL=app.min.js.map
