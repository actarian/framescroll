!function(){"use strict";/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);var i,e,t=!1,s="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",a=25,u=498,o=u/a,c=[0,2.14,5.22,9.16,12.13,16.08,o],d=[],l=15,m={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},r=document.querySelector(".page"),v=document.querySelector(".container"),p=document.querySelector(".preload"),f=document.querySelector(".video"),h=document.querySelector(".picture"),g=document.querySelector(".track"),w=document.querySelector(".steps"),L=(document.querySelector(".captions"),Array.prototype.slice.call(document.querySelectorAll(".captions-item"))),y=document.querySelector(".player-time"),E=document.querySelector(".marker-time"),b=f,x=function(){Scrollbar.use(window.OverscrollPlugin);var t=Scrollbar.init(r,{plugins:{overscroll:{}}});return t.addListener(function(e){e.offset,e.limit,r.offsetWidth,r.offsetHeight}),t.onScrollbarShouldScrollTo=function(e){document.querySelector(e.selector)===r&&t.scrollTo(e.x||0,e.y||0,500)},t.pause=function(){},t.resume=function(){return t},t}();function M(e,t){var n=parseInt(100*(e/t));p.innerHTML=n}function T(){t?v.setAttribute("class","container container-picture"):v.setAttribute("class","container container-video"),m.pow=m.end=0,0,i=null,f.pause(),g.addEventListener("mousedown",I,_),document.addEventListener("mousedown",z,_),document.addEventListener("mousemove",Y,_),document.addEventListener("mouseup",F,_),document.addEventListener("mouseleave",F,_),v.addEventListener("wheel",X),g.addEventListener("touchstart",I,_),v.addEventListener("touchstart",B,_),v.addEventListener("touchmove",Y,_),v.addEventListener("touchend",F,_),document.addEventListener("touchmove",J,_),window.onscroll=C,window.requestAnimationFrame(k),S(1)}function S(o){L.filter(function(e,t){var n=c[t]-m.pow*b.duration;2<Math.abs(n)?e.setAttribute("class","captions-item"):0<o?e.setAttribute("class","captions-item "+(-.1<n?"entering":"exiting")):o<0&&e.setAttribute("class","captions-item "+(n<.1?"entering":"exiting"))})}t?(v.setAttribute("class","container container-picture loading"),(b=h).currentTime=0,b.duration=o,b.play=b.pause=function(){},b.setTime=function(){var e=Math.max(1,Math.min(u,Math.round(b.currentTime*a)));b.index!==e&&(b.index=e,b.src=d[e])},function(){var o=u,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);d[n]=t,r++,i.shift(),M(r,o),r===o?(b.setTime(),T()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(v.setAttribute("class","container container-video loading"),(b=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){M(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=t;var n=f.play();void 0!==n?n.then(function(){T()}).catch(function(e){console.log("video.error",e,f.error)}):T()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';w.innerHTML+=t}}();var A=window.peformance?performance:Date,q=1e3/a,P=0,H=0,R=0;function k(){P=A.now(),q<(R=P-H)&&(H=P-R%q,function(){if(b.duration){if(i)m.pow=m.end,b.pause(),b.currentTime=m.pow*b.duration,b.setTime();else if(m.end!==m.pow){b.paused||b.pause();var e=m.end-m.pow,t=1/a;if(Math.abs(e*b.duration)<t)m.pow=m.end;else{var n=e?e/Math.abs(e):0;m.pow+=t*n/b.duration}var o=Math.round(m.pow*b.duration/t)*t+1e-5;b.currentTime=o,b.setTime()}var r=g.offsetHeight;y.setAttribute("style","top:"+b.currentTime/b.duration*r+"px;"),S(m.direction)}}()),requestAnimationFrame(k)}function I(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&N(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function j(e){return e.clientY||e.touches[0].pageY}function D(e){var t=!1;return(m.pow<1&&1===e||(!x||x.offset.y<10)&&-1===e)&&(t=!0),t?x.pause():x=x.resume(),t}var G,O=0;function U(e){if(x.offset.y<10){var t=j(e);i=t,O=m.end||0}}function Y(e){if(i){var t=j(e);if(G=t,1<Math.abs(i-t)){var n=(i-t)/(3*window.innerHeight);m.end=Math.max(0,Math.min(1,O+n))}if(D(0<t-i?-1:1))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}function F(e){if(i){var t=i-G;if(t){i=null;var n=t/Math.abs(t),o=m.end*b.duration;c.filter(function(e,t){e<o&&o<c[t+1]&&(m.index=t+(0<n?0:1))}),W(n)}}}function X(e){var t=e.deltaY/Math.abs(e.deltaY);if(W(t),D(t))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}function C(){var e=g.offsetHeight;E.setAttribute("style","top : "+m.end*(e-30)+"px;")}function N(e){if(e!==m.index){var t=(e-m.index)/Math.abs(e-m.index),n=c[m.index],o=c[e],r=m.pow*b.duration;if(r>=Math.min(n,o)&&r<=Math.max(n,o)){m.index=e,m.endTime=c[m.index],m.direction=t,m.end=m.endTime/b.duration;var i=g.offsetHeight;E.setAttribute("style","top : "+m.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function W(e){m.index;N(1===e?Math.min(c.length-1,m.index+1):Math.max(0,m.index-1))}var _=window.PointerEvent?{passive:!1,capture:!0}:void 0;function z(e){g.removeEventListener("touchstart",I),v.removeEventListener("touchstart",B),v.removeEventListener("touchmove",Y),v.removeEventListener("touchend",F),document.removeEventListener("touchmove",J),console.log("removeTouchEvents"),U(e)}function B(e){g.removeEventListener("mousedown",I),document.removeEventListener("mousedown",z),document.removeEventListener("mousemove",Y),document.removeEventListener("mouseup",F),document.removeEventListener("mouseleave",F),console.log("removeMouseEvents"),U(e)}function J(e){console.log("onTouchMove",e.target,e)}}();
//# sourceMappingURL=app.min.js.map
