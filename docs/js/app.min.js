!function(){"use strict";/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);var i,e,t=!1,s="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",a=25,c=498,o=c/a,u=[0,2.14,5.22,9.16,12.13,16.08,o],d=[],l=15,r=function(){var n=document.querySelector(".page");Scrollbar.use(window.OverscrollPlugin);var t=Scrollbar.init(n,{plugins:{overscroll:{}}});return t.addListener(function(e){var t={offset:e.offset,limit:e.limit,container:{width:n.offsetWidth,height:n.offsetHeight}};console.log("Scrollbar.onChange",t)}),t.onScrollbarShouldScrollTo=function(e){console.log("Scrollbar.onScrollbarShouldScrollTo",e),document.querySelector(e.selector)===n&&t.scrollTo(e.x||0,e.y||0,500)},t}(),v={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},m=document.querySelector(".container"),p=document.querySelector(".preload"),f=document.querySelector(".video"),w=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),L=(document.querySelector(".captions"),Array.prototype.slice.call(document.querySelectorAll(".captions-item"))),b=document.querySelector(".player-time"),y=document.querySelector(".marker-time"),E=f;function x(e,t){var n=parseInt(100*(e/t));p.innerHTML=n}function S(){t?m.setAttribute("class","container container-picture"):m.setAttribute("class","container container-video"),v.pow=v.end=0,0,i=null,f.pause(),h.addEventListener("mousedown",R),window.addEventListener("mousedown",X),window.addEventListener("mousemove",G),window.addEventListener("mouseup",O),window.addEventListener("mouseleave",O),m.addEventListener("wheel",U),h.addEventListener("touchstart",R),window.addEventListener("touchstart",N),window.addEventListener("touchmove",G),window.addEventListener("touchend",O),window.onscroll=Y,window.requestAnimationFrame(P)}t?(m.setAttribute("class","container container-picture loading"),(E=w).currentTime=0,E.duration=o,E.play=E.pause=function(){},E.setTime=function(){var e=Math.max(1,Math.min(c,Math.round(E.currentTime*a)));E.index!==e&&(E.index=e,E.src=d[e])},function(){var o=c,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);d[n]=t,r++,i.shift(),x(r,o),r===o?(E.setTime(),S()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(m.setAttribute("class","container container-video loading"),(E=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=t;var n=f.play();void 0!==n?n.then(function(){S()}).catch(function(e){console.log("video.error",e,f.error)}):S()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<u.length;e++){var t='<div class="step" style="top:'+(u[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var T=window.peformance?performance:Date,M=1e3/a,A=0,q=0,H=0;function P(){A=T.now(),M<(H=A-q)&&(q=A-H%M,function(){if(E.duration){if(i)v.pow=v.end,E.pause(),E.currentTime=v.pow*E.duration,E.setTime();else if(v.end!==v.pow){E.paused||E.pause();var e=v.end-v.pow,t=1/a;if(Math.abs(e*E.duration)<t)v.pow=v.end;else{var n=e?e/Math.abs(e):0;v.pow+=t*n/E.duration}var o=Math.round(v.pow*E.duration/t)*t+1e-5;E.currentTime=o,E.setTime()}var r=h.offsetHeight;b.setAttribute("style","top:"+E.currentTime/E.duration*r+"px;"),L.filter(function(e,t){var n=u[t]-v.pow*E.duration;2<Math.abs(n)?e.setAttribute("class","captions-item"):0<v.direction?e.setAttribute("class","captions-item "+(-.1<n?"entering":"exiting")):v.direction<0&&e.setAttribute("class","captions-item "+(n<.1?"entering":"exiting"))})}}()),requestAnimationFrame(P)}function R(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&F(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function k(e){return e.clientY||e.touches[0].pageY}var I,j=0;function D(e){var t=k(e);i=t,j=v.end||0}function G(e){if(i){var t=k(e);if(I=t,1<Math.abs(i-t)){var n=(i-t)/(3*window.innerHeight);v.end=Math.max(0,Math.min(1,j+n))}return e.preventDefault(),e.stopImmediatePropagation(),!1}}function O(e){if(i){var t=i-I;if(t){i=null;var n=t/Math.abs(t),o=v.end*E.duration;u.filter(function(e,t){e<o&&o<u[t+1]&&(v.index=t+(0<n?0:1))}),C(n)}}}function U(e){var t=e.deltaY/Math.abs(e.deltaY);return C(t),(v.pow<1||0===r.offset.y&&-1===t)&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),r.setPosition(0,0)),!1}function Y(){var e=h.offsetHeight;y.setAttribute("style","top : "+v.end*(e-30)+"px;")}function F(e){if(e!==v.index){var t=(e-v.index)/Math.abs(e-v.index),n=u[v.index],o=u[e],r=v.pow*E.duration;if(r>=Math.min(n,o)&&r<=Math.max(n,o)){v.index=e,v.endTime=u[v.index],v.direction=t,v.end=v.endTime/E.duration;var i=h.offsetHeight;y.setAttribute("style","top : "+v.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function C(e){v.index;F(1===e?Math.min(u.length-1,v.index+1):Math.max(0,v.index-1))}function X(e){h.removeEventListener("touchstart",R),window.removeEventListener("touchstart",N),window.removeEventListener("touchmove",G),window.removeEventListener("touchend",O),console.log("removeTouchEvents"),D(e)}function N(e){h.removeEventListener("mousedown",R),window.removeEventListener("mousedown",X),window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",O),window.removeEventListener("mouseleave",O),m.removeEventListener("wheel",U),console.log("removeMouseEvents"),D(e)}}();
//# sourceMappingURL=app.min.js.map
