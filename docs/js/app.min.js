!function(){"use strict";var r,e,t=!1,s="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo.webm?c",a=25,c=498,o=c/a,d=[0,2.14,5.22,9.16,12.13,16.08,o],u=[],l=15,p={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},f=document.querySelector(".container"),m=document.querySelector(".content"),i=document.querySelector(".preload"),w=document.querySelector(".video"),v=document.querySelector(".picture"),h=document.querySelector(".track"),g=document.querySelector(".steps"),x=document.querySelector(".circle-time"),T=document.querySelector(".circle-scroll"),M=w;function b(e,t){var n=parseInt(100*(e/t));i.innerHTML=n}function y(){t?f.setAttribute("class","container container-picture"):f.setAttribute("class","container container-video"),p.pow=p.end=0,0,r=null,w.pause(),h.addEventListener("mousedown",Y),window.addEventListener("mousedown",R),window.addEventListener("mousemove",j),window.addEventListener("mouseup",D),window.addEventListener("mouseleave",D),window.addEventListener("wheel",U),window.onscroll=F,window.requestAnimationFrame(E)}t?(f.setAttribute("class","container container-picture loading"),(M=v).currentTime=0,M.duration=o,M.play=M.pause=function(){},M.setTime=function(){var e=Math.max(1,Math.min(c,Math.round(M.currentTime*a)));M.index!==e&&(M.index=e,M.src=u[e])},function(){var o=c,i=0,e=0,r=[];function a(){for(;r.length<l&&e<o;)r.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);u[n]=t,i++,r.shift(),b(i,o),i===o?(M.setTime(),y()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(f.setAttribute("class","container container-video loading"),(M=w).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){b(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);w.src=t,y()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<d.length;e++){var t='<div class="step" style="top:'+(d[e]/o*100).toFixed(3)+'%"></div>';g.innerHTML+=t}}();var L=window.peformance?performance:Date,q=1e3/a,S=0,A=0,H=0;function E(){S=L.now(),q<(H=S-A)&&(A=S-H%q,function(){if(M.duration){if(r)p.pow=p.end,M.pause(),M.currentTime=p.pow*M.duration,M.setTime();else if(p.end!==p.pow){M.paused||M.pause();var e=p.end-p.pow,t=1/a;if(Math.abs(e*M.duration)<t)p.pow=p.end;else{var n=e?e/Math.abs(e):0;p.pow+=t*n/M.duration}var o=Math.round(p.pow*M.duration/t)*t+1e-5;M.currentTime=o,M.setTime()}var i=f.offsetHeight;m.offsetHeight,x.setAttribute("style","top:"+(15+M.currentTime/M.duration*(i-30))+"px;")}}()),requestAnimationFrame(E)}function Y(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&G(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}var k=0;function R(e){r=e.clientY,k=p.end||0,console.log("onDown",r,k)}function j(e){if(r&&1<Math.abs(r-e.clientY)){var t=(r-e.clientY)/(3*window.innerHeight);p.end=Math.max(0,Math.min(1,k+t)),O()}}function D(e){if(r){var t=r-e.clientY;if(console.log(e.clientY,r,t),t){r=null;var n=t/Math.abs(t),o=p.end*M.duration;d.filter(function(e,t){e<o&&o<d[t+1]&&(p.index=t+(0<n?0:1))}),I(n),O()}}}function U(e){I(e.deltaY/Math.abs(e.deltaY)),O()}function F(){var e=f.offsetHeight;T.setAttribute("style","top : "+(15+p.end*(e-30))+"px;")}function G(e){if(console.log("setIndex",e),e!==p.index){var t=(e-p.index)/Math.abs(e-p.index),n=d[p.index],o=d[e],i=p.pow*M.duration;if(i>=Math.min(n,o)&&i<=Math.max(n,o)){p.index=e,p.endTime=d[p.index],p.direction=t,p.end=p.endTime/M.duration,console.log("setNearestDirection",e,n,o,i);var r=f.offsetHeight;T.setAttribute("style","top : "+(15+p.end*(r-30))+"px;"),$(".slick").slick("slickGoTo",e)}}}function I(e){p.index;G(1===e?Math.min(d.length-1,p.index+1):Math.max(0,p.index-1))}function O(){var e=f.offsetHeight,t=m.offsetHeight-e,n=p.end*t;window.scrollTo(0,Math.max(0,Math.min(t,n)))}$(document).ready(function(){$(".slick").slick({infinite:!1,slidesToShow:1,slidesToScroll:1,vertical:!0,arrows:!1,dots:!1,swipe:!1,swipeToSlide:!1,verticalSwiping:!1})})}();
//# sourceMappingURL=app.min.js.map
