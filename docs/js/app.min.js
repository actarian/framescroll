!function(){"use strict";/iPad|iPhone|iPod/.test(navigator.userAgent)&&window.MSStream,/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor);var i,e,t=!1,s="img/campagnolo/campagnolo_{0}.jpg",n="img/campagnolo2.mp4",a=25,u=498,o=u/a,c=[0,2.14,5.22,9.16,12.13,16.08,o],d=[],l=15,r=function(){var t=document.querySelector(".page");Scrollbar.use(window.OverscrollPlugin);var n=Scrollbar.init(t,{plugins:{overscroll:{}}});return n.addListener(function(e){e.offset,e.limit,t.offsetWidth,t.offsetHeight}),n.onScrollbarShouldScrollTo=function(e){document.querySelector(e.selector)===t&&n.scrollTo(e.x||0,e.y||0,500)},n}(),p={pow:0,end:0,endTime:0,previous:0,direction:0,diff:0,index:0},v=document.querySelector(".container"),m=document.querySelector(".preload"),f=document.querySelector(".video"),w=document.querySelector(".picture"),g=document.querySelector(".track"),h=document.querySelector(".steps"),L=(document.querySelector(".captions"),Array.prototype.slice.call(document.querySelectorAll(".captions-item"))),y=document.querySelector(".player-time"),E=document.querySelector(".marker-time"),b=f;function x(e,t){var n=parseInt(100*(e/t));m.innerHTML=n}function M(){t?v.setAttribute("class","container container-picture"):v.setAttribute("class","container container-video"),p.pow=p.end=0,0,i=null,f.pause(),g.addEventListener("mousedown",I,W),window.addEventListener("mousedown",_,W),window.addEventListener("mousemove",U,W),window.addEventListener("mouseup",Y,W),window.addEventListener("mouseleave",Y,W),v.addEventListener("wheel",F),g.addEventListener("touchstart",I,W),window.addEventListener("touchstart",z,W),window.addEventListener("touchmove",U,W),window.addEventListener("touchend",Y,W),window.onscroll=X,window.requestAnimationFrame(k),T(1)}function T(o){L.filter(function(e,t){var n=c[t]-p.pow*b.duration;2<Math.abs(n)?e.setAttribute("class","captions-item"):0<o?e.setAttribute("class","captions-item "+(-.1<n?"entering":"exiting")):o<0&&e.setAttribute("class","captions-item "+(n<.1?"entering":"exiting"))})}t?(v.setAttribute("class","container container-picture loading"),(b=w).currentTime=0,b.duration=o,b.play=b.pause=function(){},b.setTime=function(){var e=Math.max(1,Math.min(u,Math.round(b.currentTime*a)));b.index!==e&&(b.index=e,b.src=d[e])},function(){var o=u,r=0,e=0,i=[];function a(){for(;i.length<l&&e<o;)i.push(!0),t(++e)}function t(n){var e=new XMLHttpRequest;e.open("GET",s.split("{0}").join(n),!0),e.responseType="blob",e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);d[n]=t,r++,i.shift(),x(r,o),r===o?(b.setTime(),M()):a()}},e.onerror=function(e){console.log("preload.error",e)},e.send()}a()}()):(v.setAttribute("class","container container-video loading"),(b=f).setTime=function(){},(e=new XMLHttpRequest).open("GET",n,!0),e.responseType="blob",e.onprogress=function(e){x(e.loaded,e.total)},e.onload=function(){if(200===this.status){var e=this.response,t=URL.createObjectURL(e);f.addEventListener("progress",function(e){console.log("video.progress",e,f.duration)},!1),f.addEventListener("error",function(e){console.log("video.error",e,f.error)}),f.autoplay=!0,f.mute=!0,f.src=t;var n=f.play();void 0!==n?n.then(function(){M()}).catch(function(e){console.log("video.error",e,f.error)}):M()}},e.onerror=function(e){console.log("preload.error",e)},e.send()),function(){for(var e=0;e<c.length;e++){var t='<div class="step" style="top:'+(c[e]/o*100).toFixed(3)+'%"></div>';h.innerHTML+=t}}();var S=window.peformance?performance:Date,A=1e3/a,q=0,P=0,H=0;function k(){q=S.now(),A<(H=q-P)&&(P=q-H%A,function(){if(b.duration){if(i)p.pow=p.end,b.pause(),b.currentTime=p.pow*b.duration,b.setTime();else if(p.end!==p.pow){b.paused||b.pause();var e=p.end-p.pow,t=1/a;if(Math.abs(e*b.duration)<t)p.pow=p.end;else{var n=e?e/Math.abs(e):0;p.pow+=t*n/b.duration}var o=Math.round(p.pow*b.duration/t)*t+1e-5;b.currentTime=o,b.setTime()}var r=g.offsetHeight;y.setAttribute("style","top:"+b.currentTime/b.duration*r+"px;"),T(p.direction)}}()),requestAnimationFrame(k)}function I(e){(e.preventDefault(),e.stopImmediatePropagation(),"step"===e.target.getAttribute("class"))&&C(Array.prototype.slice.call(e.target.parentNode.children).indexOf(e.target));return!1}function R(e){return e.clientY||e.touches[0].pageY}function D(e){var t=!1;return(p.pow<1&&1===e||r.offset.y<10&&-1===e)&&(t=!0),t?r.unregisterEvents(/./):r.registerEvents(/./),console.log("shouldLockScroll",t,e,p.pow,r.offset.y,e),t}var j,G=0;function O(e){if(r.offset.y<10){var t=R(e);if(i=t,G=p.end||0,D(1))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}function U(e){if(i){var t=R(e);if(j=t,1<Math.abs(i-t)){var n=(i-t)/(3*window.innerHeight);p.end=Math.max(0,Math.min(1,G+n))}if(D(0<t-i?-1:1))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}}function Y(e){if(i){var t=i-j;if(t){i=null;var n=t/Math.abs(t),o=p.end*b.duration;c.filter(function(e,t){e<o&&o<c[t+1]&&(p.index=t+(0<n?0:1))}),N(n)}}}function F(e){var t=e.deltaY/Math.abs(e.deltaY);if(N(t),D(t))return e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1}function X(){var e=g.offsetHeight;E.setAttribute("style","top : "+p.end*(e-30)+"px;")}function C(e){if(e!==p.index){var t=(e-p.index)/Math.abs(e-p.index),n=c[p.index],o=c[e],r=p.pow*b.duration;if(r>=Math.min(n,o)&&r<=Math.max(n,o)){p.index=e,p.endTime=c[p.index],p.direction=t,p.end=p.endTime/b.duration;var i=g.offsetHeight;E.setAttribute("style","top : "+p.end*i+"px;"),$(".slick").slick("slickGoTo",e)}}}function N(e){p.index;C(1===e?Math.min(c.length-1,p.index+1):Math.max(0,p.index-1))}var W=window.PointerEvent?{passive:!1,capture:!0}:void 0;function _(e){g.removeEventListener("touchstart",I),window.removeEventListener("touchstart",z),window.removeEventListener("touchmove",U),window.removeEventListener("touchend",Y),console.log("removeTouchEvents"),O(e)}function z(e){g.removeEventListener("mousedown",I),window.removeEventListener("mousedown",_),window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",Y),window.removeEventListener("mouseleave",Y),console.log("removeMouseEvents"),O(e)}}();
//# sourceMappingURL=app.min.js.map
